<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>运维管理-首页</title>
<link href="css/styles.css" rel="stylesheet" type="text/css">
<link href="css/common.css" rel="stylesheet" type="text/css">
</head>
<body>
	<div class="login_header">
		<div class="tw_half_min tw_f_l txt_center pro_title">运维管理工具</div>
		<div class="tw_half_min tw_f_r txt_center">当前用户:&nbsp;<span class="txt_red" id="user_userid">lsgjw3</span>&nbsp;
		<a class="a_blue" href="javascript:void(0);" onclick="logOut()">退出</a>
		</div>
	</div>
	<div class="i_content_main">
		<div class="f_menue" id="f_menue">
			<iframe class="mf" src="my_menue.html" style="border:none;"></iframe>
		</div>
		<div class="i_canvas block_radius_max">
		</div>
	</div>
	<div class="footer">
		<div class="tw_dialog_canv" id="grpYq" style="display:none;">
        	<div class="dialog_canv_top">
            	<div class="dialog_canv_t">邀请加入(组)</div>
                <span class="icon icon_close tw_close_btn close_0"></span>
            </div>
            <div class="canv_line txt_center">
                <label>用户名：</label>
				<input type="text" id="userid" class="short" placeholder="账号/邮箱/地址"/>
            </div>
            <div class="canv_line txt_center">
            	<a class="tw_btn_light btn_short tw_close_btn close_1">确认</a>
                <a class="tw_btn_white btn_short tw_close_btn close_2">取消</a>
            </div> 
        </div>
	</div>
</body>
</html>
<script src="plugins/jquery-1.9.1.js" type="text/javascript"></script>
<script src="js/tools.js" type="text/javascript"></script>
<script  type="text/javascript">
var userid=getLocalCache("userid");
var canvClose=function(idx)
{
	return true;
}
var yqFun=function(idx)
{
	var userid=$("#userid").val();
	var group=getLocalCache("group");
	if(userid=="")
	{
		showMsg("用户名不能为空");
		return false;
	}
	else if(isEmpty(group))
	{
		showMsg("当前没有指定组，不能发起邀请");
		return false;
	}
	$.ajax({type:'POST',
	  url: getHost()+"group/attach?token="+getLocalCache("token"),
	  data:{},
	  success: function(data){
	  if(data)
	  {
		var obj=eval('(' + data + ')');
		if(obj.code==0)
		{
			showMsg("邀请已发出");
			return true;
		}
		else
		{
			showMsg("发出邀请失败");
			return false;
		}
	  }
	 },
	 error: function()
	 {
		showMsg("提交邀请失败");
		return false;
		}
	});
}
function openYqPan()
{
	htmlElementWinUp($("#grpYq"),300,160,null,[canvClose,yqFun,canvClose]);
}
jQuery(function()
{
	$("#user_userid").text(userid);
});
function logOut()
{
	$.ajax({type:'GET',
	  url: getHost()+"user/logout",
	  data:{},
	  success: function(data){
	  if(data)
	  {
		var obj=eval('(' + data + ')');
		if(obj.code==0)
		{
			setLocalCache("token",'null');
			setLocalCache("userid",'null');
			window.location.href="login.html";
		}
		else
		{
			showMsg("退出失败");
		}
	  }
	 },
	 error: function()
	 {
		showMsg("提交请求失败");
		}
	});
}
</script>
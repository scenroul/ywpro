<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>运维管理-成员列表</title>
<link href="css/styles.css" rel="stylesheet" type="text/css">
<link href="css/common.css" rel="stylesheet" type="text/css">
</head>
<body>
	<div class="login_header">
		<div class="tw_half_min tw_f_l txt_center pro_title">运维管理工具</div>
		<div class="tw_half_min tw_f_r txt_center">当前用户:&nbsp;<span class="txt_red" id="user_userid">lsgjw3</span>&nbsp;
		<a class="a_blue" href="javascript:void(0);" onclick="logOut()">退出</a>
		</div>
	</div>
	<div class="i_content_main">
		<div class="f_menue" id="f_menue">
			<div class="menue_t txt_center">当前组：<select id="my_groups" onchange="gChanged()">
				<option value="0">空</option>
			</select>
			<div class="icon icon_add" onclick="openAddPan()">+</div>
			</div>
			<div class='add_canv txt_center'>
				<input type="text" id="newName" class="mini" value="" placeholder="组名"/>
				<input type="button" id="toAdd" class="mini" value="添加" onclick="confirmAdd()"/>
			</div>
			<iframe class="mf" src="my_menue.html" style="border:none;"></iframe>
			<div class="menue_b txt_center"></div>
			<div class="icon icon_dele">解散组</div>
			<div class="icon icon_yq" onclick="openYqPan()">邀请</div>
		</div>
		<div class="i_canvas block_radius_max" id="user_list">
		</div>
	</div>
	<div class="footer">
		<div class="tw_dialog_canv" id="grpYq" style="display:none;">
        	<div class="dialog_canv_top">
            	<div class="dialog_canv_t">邀请加入(组)</div>
                <span class="icon icon_close tw_close_btn close_0"></span>
            </div>
            <div class="canv_line txt_center">
                <label>用户名：</label>
				<input type="text" id="userid" class="short" placeholder="账号/邮箱/地址"/>
            </div>
            <div class="canv_line txt_center">
            	<a class="tw_btn_light btn_short tw_close_btn close_1">确认</a>
                <a class="tw_btn_white btn_short tw_close_btn close_2">取消</a>
            </div> 
        </div>
	</div>
</body>
</html>
<script src="plugins/jquery-1.9.1.js" type="text/javascript"></script>
<script src="js/tools.js" type="text/javascript"></script>
<script src="js/index.js" type="text/javascript"></script>
<script  type="text/javascript">
jQuery(function()
{
	var group=getLocalCache("group");
	loadUsers(group);
});
function loadUsers(grp)
{
	$("#user_list").html(loadingText());
	$.ajax({type:'GET',
	  url: getHost()+"group/user?token="+getLocalCache("token"),
	  data:{"groupname":grp},
	  success: function(data){
	  if(data)
	  {
		var obj=eval('(' + data + ')');
		if(obj.code==0)
		{
			var jobj=JSON.parse(obj.data);
			initUserList(jobj);
		}
		else
		{
			$("#user_list").html("");
			showMsg("请求成员失败");
		}
	  }
	 },
	 error: function()
	 {
		$("#user_list").html("");
		showMsg("提交请求失败");
		}
	});
}
function initUserList(list)
{
	var listHtml=
	"<div class='tb_line line_t'><div class='cell cell_mini'><input type='checkbox' id='line_check' onclick='checkAll(this)'/></div>"+
	"<div class='cell  cell_middle'>用户名</div><div class='cell cell_long'>电话</div><div class='cell cell_long'>邮箱</div>"+
	"<div class='cell cell_long'>操作</div></div>";
	for(var u=0;u<list.length;u++)
	{
		var stl=u%2;
		listHtml+="<div class='tb_line line_"+stl+
		"'><div class='cell cell_mini'><input type='checkbox' class='line_check'/></div><div class='cell  cell_middle'>"+
		list[u].username+"</div><div class='cell cell_long'>"+list[u].phone+"</div><div class='cell cell_long'>"+
		list[u].email+"</div><div class='cell cell_long'>&nbsp;</div></div>";
	}
	$("#user_list").html(listHtml);
}
</script>